<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>数据库与文件备份 | Sevenhzhang的博客 | Make Progress</title>

  
  <meta name="author" content="Sevenhzhang">
  

  
  <meta name="description" content="九层之台，起于累土">
  

  
  <meta name="keywords" content="Python">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="数据库与文件备份"/>

  <meta property="og:site_name" content="Sevenhzhang的博客"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Sevenhzhang的博客" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 4.2.0"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">Sevenhzhang的博客</a>
    </h1>
    <p class="site-description">Make Progress</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>数据库与文件备份</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2020/03/01/数据库与文件备份/" rel="bookmark">
        <time class="entry-date published" datetime="2020-03-01T15:35:00.000Z">
          2020-03-01
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <a id="more"></a>

<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">rem auther:zhanghui</span></span><br><span class="line"><span class="comment">rem date:20181122</span></span><br><span class="line"><span class="comment">rem ******MySQL backup start********</span></span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="comment">rem forfiles /p "G:\bupt_backup" /m backup_*.sql -d -30 /c "cmd /c del /f @path"</span></span><br><span class="line"><span class="comment">rem forfiles 用来对备份目录下的过期备份进行删除。</span></span><br><span class="line"><span class="comment">rem “E:\mysql\MySQL BackUp”是备份文件所在的路径，可以自行修改。</span></span><br><span class="line"><span class="comment">rem “backup_*.sql”指的是该路径下所有以“backup_”开头，以“.sql”作为后缀的数据库备份文件。</span></span><br><span class="line"><span class="comment">rem 而后面的数字“30”表示30天过期。</span></span><br><span class="line"></span><br><span class="line">robocopy G:\APUE G:\backup-test /E /R:<span class="number">5</span> /W:<span class="number">60</span> /LOG+:G:\backup-test\copyLog.txt</span><br><span class="line"><span class="comment">rem 路径前者为需要备份的文件路径，后者为备份路径。</span></span><br><span class="line"><span class="comment">rem /E  表示复制子目录，包括空的子目录（不设置这个就只复制当前文件夹文件不复制子文件夹）</span></span><br><span class="line"><span class="comment">rem /MAXAGE:2 表示最长的文件存在时间，排除早于2天的文件（没有这个就是全部复制）</span></span><br><span class="line"><span class="comment">rem /W:n :: 两次重试间的等待时间: 默认为 30 秒。</span></span><br><span class="line"><span class="comment">rem /R:5 表示失败副本的重试次数（建议要设，默认值为一百万 = =）</span></span><br><span class="line"><span class="comment">rem /LOG+:D\xxx.txt  将状态输出到日志文件（附加到现有日志中）</span></span><br><span class="line"><span class="comment">rem 更多用法可在cmd中输入：help robocopy查看</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> "Ymd=<span class="variable">%date:~0,4%</span><span class="variable">%date:~5,2%</span><span class="variable">%date:~8,2%</span><span class="number">0</span><span class="variable">%time:~1,1%</span><span class="variable">%time:~3,2%</span><span class="variable">%time:~6,2%</span>"</span><br><span class="line"><span class="comment">rem 使用set命令来定义一个名为“Ymd”的变量，这个变量的值就是后面的一大串规则，简单说就是当前的日期和时间</span></span><br><span class="line"><span class="function">E:\<span class="title">Software_work</span>\<span class="title">xampp</span>\<span class="title">mysql</span>\<span class="title">bin</span>\<span class="title">mysqldump</span> --<span class="title">opt</span> --<span class="title">single</span>-<span class="title">transaction</span>=<span class="title">TRUE</span> --<span class="title">user</span>=<span class="title">root</span> --<span class="title">password</span>=<span class="title">root</span> --<span class="title">host</span>=127.0.0.1 --<span class="title">protocol</span>=<span class="title">tcp</span> --<span class="title">port</span>=3306 --<span class="title">default</span>-<span class="title">character</span>-<span class="title">set</span>=<span class="title">utf8</span> --<span class="title">single</span>-<span class="title">transaction</span>=<span class="title">TRUE</span> --<span class="title">routines</span> --<span class="title">events</span> "<span class="title">bupt</span>" &gt; "<span class="title">G</span>:\<span class="title">bupt_backup</span>\<span class="title">backup_</span>%<span class="title">Ymd</span>%.<span class="title">sql</span>"</span></span><br><span class="line"><span class="function"><span class="title">rem</span> @<span class="title">echo</span> <span class="title">on</span></span></span><br><span class="line"><span class="function"><span class="title">rem</span> ******<span class="title">MySQL</span> <span class="title">backup</span> <span class="title">end</span>********</span></span><br></pre></td></tr></table></figure>


      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/数据库/">数据库</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/备份/">备份</a>
    </span>
    

    </div>

    
  </div>
</article>

  






    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2020 Sevenhzhang
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>